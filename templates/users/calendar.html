{% extends "dashboard/base.html" %}
{% load static %}

{% block title %}Calendar - GymBuddy{% endblock %}
{% block page_title %}Calendar{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Calendar Navigation -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-4 sm:p-6">
        <div class="flex items-center justify-between">
            <a 
                href="?year={{ prev_year }}&month={{ prev_month }}"
                class="inline-flex items-center space-x-2 px-4 py-2 text-slate-700 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-colors duration-200"
            >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                <span>Previous</span>
            </a>
            <h2 class="text-xl font-semibold text-slate-900">
                {{ month_name }} {{ year }}
            </h2>
            <a 
                href="?year={{ next_year }}&month={{ next_month }}"
                class="inline-flex items-center space-x-2 px-4 py-2 text-slate-700 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-colors duration-200"
            >
                <span>Next</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </a>
        </div>
    </div>

    <!-- Calendar -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
        <div class="grid grid-cols-7 gap-px bg-slate-200">
            <!-- Day Headers -->
            <div class="bg-slate-50 p-3 text-center text-xs font-semibold text-slate-700 uppercase">Sun</div>
            <div class="bg-slate-50 p-3 text-center text-xs font-semibold text-slate-700 uppercase">Mon</div>
            <div class="bg-slate-50 p-3 text-center text-xs font-semibold text-slate-700 uppercase">Tue</div>
            <div class="bg-slate-50 p-3 text-center text-xs font-semibold text-slate-700 uppercase">Wed</div>
            <div class="bg-slate-50 p-3 text-center text-xs font-semibold text-slate-700 uppercase">Thu</div>
            <div class="bg-slate-50 p-3 text-center text-xs font-semibold text-slate-700 uppercase">Fri</div>
            <div class="bg-slate-50 p-3 text-center text-xs font-semibold text-slate-700 uppercase">Sat</div>

            <!-- Calendar Days -->
            {% for week in calendar_days %}
                {% for day_data in week %}
                    {% if day_data %}
                        <div class="bg-white p-2 min-h-[100px] border-b border-r border-slate-200 {% if day_data.is_today %}bg-emerald-50{% else %}hover:bg-slate-50{% endif %} transition-colors">
                            <div class="text-sm font-semibold {% if day_data.is_today %}text-emerald-700{% else %}text-slate-900{% endif %} mb-1">
                                {{ day_data.day }}
                            </div>
                            <div class="space-y-1">
                                {% for session in day_data.sessions %}
                                    <a href="{% url 'users:training_session_update' session.pk %}" class="block text-xs p-1 rounded {% if session.status == 'CANCELLED' %}bg-red-100 text-red-800{% elif session.status == 'COMPLETED' %}bg-slate-100 text-slate-800{% else %}bg-emerald-100 text-emerald-800{% endif %} truncate hover:opacity-80" title="{{ session.trainer.get_full_name|default:session.trainer.username }} - {{ session.start_time|time:'H:i' }}">
                                        {{ session.start_time|time:"H:i" }} - {% if user.is_trainer %}{{ session.trainee.first_name|default:session.trainee.username|truncatechars:10 }}{% else %}{{ session.trainer.first_name|default:session.trainer.username|truncatechars:10 }}{% endif %}
                                    </a>
                                {% endfor %}
                            </div>
                        </div>
                    {% else %}
                        <div class="bg-slate-50 p-2 min-h-[100px] border-b border-r border-slate-200"></div>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="flex justify-end">
        <a 
            href="{% url 'users:training_session_create' %}"
            class="inline-flex items-center space-x-2 px-6 py-2 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-lg font-semibold hover:from-emerald-600 hover:to-teal-700 transform hover:scale-105 transition-all duration-200 shadow-md hover:shadow-lg"
        >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            <span>Book Session</span>
        </a>
    </div>
</div>
{% endblock %}
